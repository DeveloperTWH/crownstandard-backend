#ğŸ§  Master Prompt â€” Crownstandard Project Overview (Backend Phase)

You are working on a full-stack platform called Crownstandard â€” a cleaning-services marketplace similar to *Urban Company*, but specialized only in cleaning services.

---

ğŸ“± Project Overview

Crownstandard is a multi-role platform with three types of users:

* ğŸ‘¤ Customer: Browses services, books cleaning jobs, uploads place photos, pays online, tips providers, leaves reviews, and raises disputes if necessary.
* ğŸ§‘â€ğŸ”§ Service Provider: Registers and lists cleaning services (auto-linked to their location), gets bookings, performs jobs, earns payouts (after a 48-hour dispute window), and manages availability.
* ğŸ§‘â€ğŸ’¼ Admin: Approves providers, monitors disputes, issues refunds, controls payouts, manages visibility of services and reviews, and can broadcast notifications.

The platform supports web + mobile apps (Next.js frontend, Node.js backend, MongoDB database), with Stripe handling payments, tips, refunds, and payouts.

---

ğŸ› ï¸ Current System Features

#âœ… Core Capabilities

* ğŸ” Auth: Email/password + OAuth (Google/Apple) login, forget password flow.
* ğŸ‘¥ Unified User System: One User model for customers, providers, and admins with role-based profiles and KYC/payout info.
* ğŸ§¹ Service Listings: Providers can create, update, and manage cleaning services with pricing, media, and category classification.
* ğŸ“ Location Aware: Services are auto-linked to providerâ€™s location for search and discovery.
* ğŸ“… Booking System: Customers can book services, upload photos, receive OTP for completion, and view all booking statuses.
* ğŸ’³ Payments: Stripe integration with 25% platform fee + 75% provider payout, tip support, and payout hold/release logic.
* ğŸª™ Tips: Independent tip transactions with separate refunds and dispute handling.
* ğŸ“ Reviews: Customers can leave ratings, comments, and photos once a booking is completed.
* âš–ï¸ Disputes: Full dispute lifecycle with evidence, refunds (full/partial), and admin decisions.
* ğŸ”” Notifications: In-app + push notifications for all major events (bookings, payments, disputes, chat).
* ğŸ§¾ Audit Logs: Records every admin/system action for traceability and compliance.
* ğŸ“§ Forgot Password: Complete flow implemented and linked to role-based dashboards.
* ğŸ—ºï¸ Dashboards: Login redirects to respective dashboards (Customer â†’ Customer dashboard, Provider â†’ Provider dashboard).

---

ğŸ“¦ Data Layer Status âœ… (Completed)

We have fully designed and implemented all MongoDB models:

1. User â€“ with role, KYC, payout info, earnings, blocked dates, ratings, and profile fields.
2. ServiceCategory â€“ to organize services.
3. Service â€“ provider-listed services with admin visibility controls and currency support.
4. Booking â€“ complete booking lifecycle, OTP verification, cancellation rules, pricing snapshots, and tip summaries.
5. PaymentTransaction â€“ main payment record with payout tracking, refund data, and hold logic.
6. TipTransaction â€“ independent tip tracking with payout/refund capabilities.
7. Review â€“ customer reviews with visibility controls and rating aggregation.
8. Dispute â€“ complaint resolution model with evidence, decisions, and refund details.
9. Notification â€“ all in-app and push notifications stored and tracked.
10. AuditLog â€“ complete admin action history for compliance and debugging.

âœ… All models are finalized and production-ready.
âœ… Relationships and ERD are documented.
âœ… Stripe-compatible payment & payout logic is built into the schema.

---

ğŸ“ Current Status (As of Now)

* âœ… Schema Layer: Fully completed for all backend collections.
* âœ… Relationships & data flows: Finalized and documented.
* âœ… Auth, password reset, and dashboard linking: Implemented.
* ğŸ§­ We are currently at the start of the API layer.

---

ğŸš€ Next Step (Where to Start Now)

We are ready to begin API development. The recommended order:

1. Auth APIs â€“ signup, login, OAuth, forget/reset password.
2. User APIs â€“ profile retrieval/update, provider onboarding.
3. Service APIs â€“ CRUD for services and categories.
4. Booking APIs â€“ create, update, cancel, complete, OTP verify.
5. Payment APIs â€“ create PaymentIntent, confirm, webhook handling.
6. Tip APIs â€“ create tip, refund, webhook handling.
7. Review APIs â€“ create, list, hide/unhide.
8. Dispute APIs â€“ raise, manage, resolve disputes.
9. Notification APIs â€“ fetch and mark as read.
10. Admin APIs â€“ payout management, analytics, audit queries.

---

ğŸ“Š Business Logic Notes

* ğŸ’¸ Payment Split: Platform takes 25%, provider gets 75%, tips are 100% to provider.
* â±ï¸ Dispute Window: 48 hours hold before payout is released.
* âŒ Cancellation Policy: Free before provider accepts; 15% fee after acceptance.
* ğŸ“ Location: Auto-picked from providerâ€™s profile, searchable by service area.
* ğŸ“¸ Photo Uploads: Customer uploads required for booking.
* ğŸ”„ Refunds: Full or partial via Stripe; both booking and tip refundable.
* ğŸ§‘â€âš–ï¸ Disputes: Raised within 48h post-completion, resolved only by admin.

---

ğŸ§© Final Notes

* Backend uses Node.js + Express + MongoDB (Mongoose).
* Stripe Connect is used for payouts, fees, and tip handling.
* All models are modular and future-proofed for features like coupons, subscriptions, and promotions.
* Project name: Crownstandard.

---

Goal: Use the above context to continue backend development from the API layer starting with authentication and user management. All database models are complete â€” focus on implementing routes, controllers, middleware, and integrating them with Stripe and front-end components.


